{
  "id": "snapshot_1766326352271_lo47ddhu0",
  "approvalId": "approval_1766326339183_c2r0zb92s",
  "approvalTitle": "history-quiz 要件定義（マイページ・認証追加）承認 再依頼",
  "version": 4,
  "timestamp": "2025-12-21T14:12:32.271Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# Requirements Document\n\n## Introduction\n\nhistory-quiz は世界史の4択クイズを出題し、回答の正誤判定を行うクイズモードと、4択問題を作成できる問題作成モードを提供する。学習用途の軽量なクイズ体験を提供し、ユーザーが自作問題で学習内容を拡張できる価値を持つ。\n\n## Alignment with Product Vision\n\nプロダクトビジョン文書は未整備のため、依頼内容に基づき「世界史を楽しく学習できるクイズ体験の提供」と「ユーザーによる問題作成で学習の幅を広げる」方針に整合させる。必要に応じてビジョン文書の整備を相談する。\n\n## Requirements\n\n### Requirement 1\n\n**User Story:** 学習者として、世界史の4択クイズを解きたいので、知識の定着度を確認できるようにしたい。\n\n#### Acceptance Criteria\n\n1. WHEN クイズモードを開始したとき THEN システム SHALL 世界史の4択問題を1問表示する。\n2. WHEN ユーザーが回答を選択したとき THEN システム SHALL 正誤判定を即時に表示する。\n3. IF 正解である場合 THEN システム SHALL 正解である旨の結果を表示する。\n4. IF 不正解である場合 THEN システム SHALL 不正解である旨の結果を表示する。\n\n### Requirement 2\n\n**User Story:** 学習者として、複数の問題を連続で解きたいので、学習を継続できるようにしたい。\n\n#### Acceptance Criteria\n\n1. WHEN 正誤判定が表示されたとき THEN システム SHALL 次の問題へ進む操作を提供する。\n2. WHEN 次の問題へ進む操作を実行したとき THEN システム SHALL 別の4択問題を表示する。\n\n### Requirement 3\n\n**User Story:** 出題者として、4択の世界史問題を作成したいので、自分の学習内容を追加できるようにしたい。\n\n#### Acceptance Criteria\n\n1. WHEN 問題作成モードを開いたとき THEN システム SHALL 問題文、4つの選択肢、正解選択肢を入力できるフォームを表示する。\n2. WHEN 作成内容を送信したとき THEN システム SHALL 入力内容の保存結果を表示する。\n3. IF 入力が不完全である場合 THEN システム SHALL 必須項目の不足を示すエラーメッセージを表示する。\n\n### Requirement 4\n\n**User Story:** 学習者として、作成された問題をクイズに使いたいので、作成済み問題が出題されるようにしたい。\n\n#### Acceptance Criteria\n\n1. WHEN クイズモードで出題するとき THEN システム SHALL 保存済みの問題を出題対象に含める。\n2. IF 保存済み問題が存在しない場合 THEN システム SHALL 既定の問題セットから出題する。\n\n### Requirement 5\n\n**User Story:** システム運用者として、クライアント・APIGateway・バックエンドの責務を分離したいので、選定した通信方式で連携できるようにしたい。\n\n#### Acceptance Criteria\n\n1. WHEN クライアントがデータ取得や送信を行うとき THEN システム SHALL HTTP/JSON を介して APIGateway と通信する。\n2. WHEN APIGateway がバックエンドに処理を委譲するとき THEN システム SHALL gRPC を介して Go バックエンドと通信する。\n3. IF 選定方式で実装上の不都合が判明した場合 THEN システム SHALL 代替案を検討するための相談事項を提示する。\n\n### Requirement 6\n\n**User Story:** 学習者として、マイページで学習の進捗を確認したいので、解答履歴や正答率を把握できるようにしたい。\n\n#### Acceptance Criteria\n\n1. WHEN マイページを開いたとき THEN システム SHALL 解答履歴を表示する。\n2. WHEN マイページを開いたとき THEN システム SHALL 正答率を表示する。\n3. IF 解答履歴が存在しない場合 THEN システム SHALL 空状態の説明を表示する。\n\n### Requirement 7\n\n**User Story:** 出題者として、マイページから作成した問題を管理したいので、作成済み問題一覧を確認できるようにしたい。\n\n#### Acceptance Criteria\n\n1. WHEN マイページを開いたとき THEN システム SHALL 作成した問題の一覧を表示する。\n2. IF 作成済み問題が存在しない場合 THEN システム SHALL 空状態の説明を表示する。\n\n### Requirement 8\n\n**User Story:** 出題者として、作成した問題を修正したいので、問題を編集できるようにしたい。\n\n#### Acceptance Criteria\n\n1. WHEN 作成済み問題の編集操作を選択したとき THEN システム SHALL 問題文と選択肢を編集できるフォームを表示する。\n2. WHEN 編集内容を保存したとき THEN システム SHALL 更新結果を表示する。\n3. IF 入力が不完全である場合 THEN システム SHALL 必須項目の不足を示すエラーメッセージを表示する。\n\n### Requirement 9\n\n**User Story:** 利用者として、マイページや問題作成を自分のデータで利用したいので、ログインできるようにしたい。\n\n#### Acceptance Criteria\n\n1. WHEN ログイン画面を開いたとき THEN システム SHALL 認証情報を入力できるフォームを表示する。\n2. WHEN 認証情報を送信したとき THEN システム SHALL 認証結果を表示する。\n3. IF 認証に失敗した場合 THEN システム SHALL エラーメッセージを表示する。\n4. WHEN 認証済みでない利用者がマイページや問題作成を開こうとしたとき THEN システム SHALL ログインを促す。\n\n## Non-Functional Requirements\n\n### Code Architecture and Modularity\n- **Single Responsibility Principle**: 各モジュールは単一の責務を持つ。\n- **Modular Design**: フロント、APIGateway、バックエンドは明確に分離し、再利用可能な単位で実装する。\n- **Dependency Management**: 不要な依存を避け、各レイヤーの責務を侵食しない。\n- **Clear Interfaces**: HTTP/JSON と gRPC のインターフェースを明確に定義する。\n\n### Performance\n- クイズ取得と判定結果の表示は平均 500ms 以内を目標とする（ローカル環境）。\n- 作成済み問題の登録は平均 1s 以内を目標とする。\n\n### Security\n- 入力値はサーバー側でバリデーションする。\n- 認証・セッション管理に必要なトークンの取り扱い方針を設計時に明確化する。\n- 認可の観点から、ユーザー自身のデータのみ参照・編集できるようにする。\n\n### Reliability\n- クイズ出題と問題作成はエラー時に明確なメッセージを返し、再試行可能にする。\n\n### Usability\n- モード切替は一目で分かる導線を提供する。\n- スマートフォンでも操作可能なレスポンシブUIを提供する。\n",
  "fileStats": {
    "size": 6956,
    "lines": 125,
    "lastModified": "2025-12-21T14:06:57.851Z"
  },
  "comments": []
}